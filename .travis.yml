sudo: required

language: scala

dist: trusty

env:
  - ANDROID_HOME=$PWD/

jdk:
  - oraclejdk8

before_install:
  - npm install -g cordova
  - cd th-player
  - cordova prepare
  - cd ../

install:
    - wget --quiet --output-document=tools.zip https://dl.google.com/android/repository/sdk-tools-linux-3859397.zip
    - unzip -qq tools.zip
    - echo y | tools/bin/sdkmanager "platforms;android-25"
    - echo y | tools/bin/sdkmanager "platform-tools"
    - echo y | tools/bin/sdkmanager "build-tools;25.0.2"
    - echo y | tools/bin/sdkmanager "extras;android;m2repository"
    - echo y | tools/bin/sdkmanager "extras;google;m2repository"

script:
  - ./gradlew

deploy:
  - provider: releases
    api_key:
      secure: "ioO3dn5a4180hzDp2H2CtblQdJEoVZUuSqV4G3L52sBAp+2cxlmvFGHuu3yHWS6w3OKNiFweUPnPVczBuAbLon614Qalla+AbkhzCroBzE2HCtNaJ5bWFk8yUxeQrJkpXdfLzAvXOwI3+NRLnHPvE4GfFheDRbsUUBg5KrL0sDpJgkdg1DdIAQmZm1tc2sJCcq81nOTbZTbhAp12nGrFbS3soArMe8hIWVsZfGaEMFM5+y5BWCmsw2jvgj
             CiAWaVq1b4xB/tzg7tOtvWveFQ4SfD3whkKtbjvTtznXrNBStExzwCHMPRH3Fprwdwaj/9DXjtJ1pmZ32o3VSwrlEeFGL8131wSFbAJ+10rlywP15Q5Tc0vBnT6X4UyBlRR1z+FtF+KnBKVq810JVQkaw9FLoIWmZh3eBh9pVVluMyXQDrTjMr0AKZY5gzVl+8hHJYxa3yueZNOa8QkUXJxtain4RtmyeUD0O8UfaHn+JnGrllYn6wmdZTBjZseu6OjYO
             FMzcK8YJA4Nvk4wr+kv39Wcib/NXH5o/DMoBR/icqcEbKsw2MQDG074RQDBzhDxShu9k+0G/nFjYipVXNWt83TLtJnm69yG19k5zoGCUdX83GZ+haZdqzbSLO6/zV96v+gsARZ9h/CtsI/o3dhXW/9tmZe+1yVhtQAaqcGI8sEaY="
    file_glob: true
    file:
      - th-player/platforms/android/build/outputs/apk/debug/*.apk
      - th-server/build/libs/*.jar
    skip_cleanup: true
    on:
      tags: true
      
services:
  - rabbitmq
